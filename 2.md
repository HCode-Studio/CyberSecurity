# XSS 

## Introduction
- [S√©curiser ses applications web : Les failles XSS](https://www.youtube.com/watch?v=fbw_nkSlNco)

- [Explication des attaques XSS](https://www.youtube.com/watch?v=EoaDgUgS6QA)
- [DO NOT USE alert(1) for XSS](https://www.youtube.com/watch?v=KHwVjzWei1c)


## Demo
- D√©monstration d'une faille XSS
  ```html
  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
  </head>
  <body>
      <div>
          <h1>Demo xss</h1>
      </div>
  
      <div>
          <form action method="get" class="form">
              <input type="text" name="name" id="name">
              <input type="submit" value="Submit">
          </form>
          <p class="content"></p>
      </div>
      <?php 
          if(isset($_GET['name'])){
              $name = $_GET['name'];
              echo "<p>" . $name . "</p>";
          }
      ?>
  </body>
  </html>
  ```
- D√©monstration de la correction
 
Utiliser les fonctionnalit√©es de nos langage de programmation pour √©chapper les caract√®res sp√©ciaux dans le cas de php l'utilisation de la fonction `htmlspecialchars`

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div>
        <h1>Demo xss</h1>
    </div>

    <div>
        <form action method="get" class="form">
            <input type="text" name="name" id="name">
            <input type="submit" value="Submit">
        </form>
        <p class="content"></p>
    </div>
    <?php 
        if(isset($_GET['name'])){
            $name = $_GET['name'];
            // √âchapper les caract√®res sp√©ciaux pour pr√©venir les attaques XSS
            $safe_name = htmlspecialchars($name, ENT_QUOTES, 'UTF-8');
            echo "<p>" . $safe_name . "</p>";
        }
    ?>
</body>
</html>
```

# Exercices

**Outils √† disposition** : [XSS Strike](https://github.com/s0md3v/XSStrike)

## üî¥  Red Team


Initiation au attaque XSS [cross-site scripting](https://portswigger.net/web-security/cross-site-scripting)

[Les labs xss](https://portswigger.net/web-security/all-labs#cross-site-scripting)


Hackez Google !! Heu... Foogle !! Presque pareil.. :sweat_smile: *Les dernieres √©tape sont tr√®s difficiles arretez vous √† Angular ou Angular 2*
[XSS Game](http://www.xssgame.com/)


## üîµBlue Team

Comment se prot√©ger du XSS sur votre Framework (d√©bat ouvert) ? 

R√©flexions et r√©ponses apport√©es :

- L'√©chappement des caract√®res sp√©ciaux via les fonctions int√©gr√©es au langage de programmation utilis√© ou via une librairie type [DOM-Purify](https://github.com/cure53/DOMPurify) 
- Utilisation des [CSP (Content Security Policy)](https://developer.mozilla.org/fr/docs/Web/HTTP/CSP) authorisant uniquement les ressources voulu √† se charger sur la page
- V√©rifiez que nos outils poss√®dent bien un √©chappement de caract√®res int√©gr√©
  - exemple twig : `{{ exempleVariable }}`
  - Utilisation de [JSX pour le rendu en react](https://abhishek-gangwar.medium.com/xss-attacks-in-react-apps-and-how-to-prevent-them-cfafd2369dc5) 

- autre chose ? 

--


# üìßCSRF

## Introduction
- [S√©curiser ses applications web : Attaques CSRF](https://www.youtube.com/watch?v=xsnBRYZnBUc)

- [Cross Site Request Forgery - Computerphile](https://www.youtube.com/watch?v=vRBihr41JTo)
- [On pirate une banque ! - Attaque CSRF](https://www.youtube.com/watch?v=pELVhNdWYS8)

![Attaque CSRF](https://github.com/user-attachments/assets/df4d7d63-c336-4997-b643-ed53968bb06a)


# Exercice

## üî¥ Red Team

Challenge : [CSRF - 0 protection](https://www.root-me.org/fr/Challenges/Web-Client/CSRF-0-protection)



## üîµBlue Team

Impl√©mentez un Token CSRF dans tous vos formulaires POST ! Pas d'exception !

Est-ce bien suffisant ? 


